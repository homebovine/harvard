n
n
n
n
n
debug(A)
n
likelihood(vt, x, vg[j], theta, v) * vq[j] * likelihood(vt, 
        x, vg[i], theta, v)
v
v = 1
 likelihood(vt, x, vg[j], theta, v)
v = 0
 likelihood(vt, x, vg[j], theta, v)
vt
debug(likelihood)
n
n
n
n
vt1
n
vt
n
n
n
n
n
n
n
n
n
n
n
n
d1
n
y2
n
y1
n
hzd1(kappa1, alpha1, beta1, y1, x, g)
y1
g
x
g = 0.1
hzd1(kappa1, alpha1, beta1, y1, x, g)
g = 0.5
hzd1(kappa1, alpha1, beta1, y1, x, g)
debug(hzd1)
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
g
log(g)
 exp((trans1(t, alpha1) - t(beta1) %*% x - log(g))/kappa1)
1/t
1/ kappa1
 exp((trans1(t, alpha1) - t(beta1) %*% x - log(g))/kappa1) * 1/t
n
n
n
hzd2(kappa2, alpha2, beta2, y1, x, g)
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
hzd2(kappa2, alpha2, beta2, y1, x, g)
kappa2
hzd3(kappa3, alpha3, 
    beta3, y2, x, g)
 surv2(kappa2, alpha2, beta2, y1, x, g)
surv1(kappa1, alpha1, beta1, y1, x, 
    g)
apply(1/(1 - vt1), 1, prod)
(surv1(kappa1, alpha1, beta1, v, x, g) 
)
surv3(kappa3, alpha3, beta3,  y1, x, g) 
surv3(kappa3, alpha3, beta3,  y2, x, g) / surv3(kappa3, alpha3, beta3,  y1, x, g)
 surv3(kappa3, alpha3, beta3,  y2, x, g)
y2
y1
debug(surv3)
 surv3(kappa3, alpha3, beta3,  y2, x, g)
(trans3(t, alpha3) - log(g) - t(beta3) %*% x)/kappa3
exp((trans3(t, alpha3) - log(g) - t(beta3) %*% x)/kappa3)
g = 0
exp((trans3(t, alpha3) - log(g) - t(beta3) %*% x)/kappa3)
g = 0.2
exp((trans3(t, alpha3) - log(g) - t(beta3) %*% x)/kappa3)
exp(-exp((trans3(t, alpha3) - log(g) - t(beta3) %*% x)/kappa3))
kappa3 = 10
exp((trans3(t, alpha3) - log(g) - t(beta3) %*% x)/kappa3)
Q
source("accleft.r")
resp
survData[97, 3]
source("accleft.r")
estm(theta, resp, covm, n, p)
mA
source("accleft.r")
source("accleft.r")
estm(theta, resp, covm, n, p)
missingscore(1, theta, missresp, cmptresp, mn, cn, p, misscovm, cmptcovm, cmptscore)
ht <- n^(-1/3)
hx = rep(ht, p)
hx
ht
ix
c
source("accleft.r")
estm(theta, resp, covm, n, p)
c
source("accleft.r")
estm(theta, resp, covm, n, p)
c
.Last.vlue
.Last.value
library(BB)
?dfsane
dfsane(theta, estm, method = 2, contorl = ls(), quiet = FALSE, resp, covm, n, p)
dfsane(theta, estm, method = 2, contorl = list(), quiet = FALSE, resp, covm, n, p)
dfsane(theta, estm, method = 2, control = list(), quiet = FALSE, resp, covm, n, p)
c
source("accleft.r")
source("accleft.r")
source("accleft.r")
source("accleft.r")
warnings()
source("accleft.r")
estm(theta, resp, covm, n, p)
cmptscore
str(cmpscore)
str(cmptscore)
cmptscore
temp <- lapply(1 : cn,completescore, theta, cmptresp, cn, p, cmptcovm, cmptv)
temp[1]
debug(projscore)
completescore(1, theta, cmptresp, cn, p, comptcovm, cmptv)
completescore(1, theta, cmptresp, cn, p, cmptcovm, cmptv)
n
a
sapply(1:m, num, vg, vt, x, theta, v)
n
n
sapply(1:m, num, vg, vt, x, theta, v)
sapply(1 : m, dm, vg, vt, x,   theta, v)
Q
source("accleft.r")
estm(theta, resp, covm, n, p)
 apply(rbind(cmptscore, missscore), 2, sum)
cmptscore
str(compscore)
completescore(1, theta, cmptresp, cn, p, cmptcovm, cmmptv)
completescore(1, theta, cmptresp, cn, p, cmptcovm, cmptv)
debug(completescore)
m
completescore(1, theta, cmptresp, cn, p, cmptcovm, cmptv)
debug(projscore)
n
n
n
n
n
n
n
a
n
Q
source("accleft.r")
estm(theta, resp, covm, n, p)
 apply(rbind(cmptscore, missscore), 2, sum)
cmptscore
str(cmptscore)
missscore
cmptscore[ix, ]* kerx(x, cmptcovm[ix, ], ht)
debug(missingscore)
missscore <- do.call(rbind, lapply(1 : mn, missingscore, theta, missresp, cmptresp, mn, cn, p, misscovm, cmptcovm, cmptscore, missv))
n
n
n
n
n
n
n
ix
n
n
n
n
n
n
n
n
n
ix
n
n
n
n
n
n
n
n
n
n
ix
cn
cmptresp[, "y1"]
n
n
ix
missscore
mn
q
missscore
score
theta
Q
source("accleft.r")
spg(theta, estm, gr=NULL, method=3, project=NULL, lower=rep(0.001, length(theta)), upper=Inf, projectArgs=NULL, control=list(), quiet=FALSE, resp, covm, n, p)
source("accleft.r")
source("accleft.r")
warnings()
estm1
estm1
estm
theta
load("/Users/fjiang/harv/harvard/accleft/realresult")
apply(resmale, 2, median)
apply(resfemale, 2, median)
load("realdata")
survsd <- sd(survData[, c(1, 3)])
survData <- survData[survData[, 5] == 0, 1:4]
survData[, c(1, 3)] <- survData[, c(1, 3)]/survsd
survData[, c(1, 3)]
datafemale <- survData
load("realdata")
survData[, c(1, 3)] <- survData[, c(1, 3)]/survsd
survData <- survData[survData[, 5] == 1, 1:4]
survData[, c(1, 3)] <- survData[, c(1, 3)]/survsd
survData
datamale <- survData
save(datamale, datafemale, resmale, resfemale, file = "realresult")
load("realresult")
 apply(resmale, 2, median
)
 paramale <- apply(resmale, 2, median)
 parafemale <- apply(resfemale, 2, median)
parafemale
ls()
data <- cbind(datamale, datafemale)
data <- rbind(datamale, datafemale)
exp(log(data[, 1])/paramale[1])
exp(log(data[, 1])/paramale[1])* exp(paramale[4])
plot(exp(log(data[, 1])/paramale[1])* exp(paramale[4])~data[, 1])
plot(exp(log(data[, 3])/paramale[2])* exp(paramale[5])~data[, 3])
lines(exp(log(data[, 1])/paramale[1])* exp(paramale[4])~data[, 1])
plot(exp(log(data[, 3])/paramale[2])* exp(paramale[5])~data[, 3])
points(exp(log(data[, 1])/paramale[1])* exp(paramale[4])~data[, 1])
points(exp(log(data[, 3])/paramale[3])* exp(paramale[6])~data[, 3])
plot(exp(log(data[, 3])/parafemale[2])* exp(parafemale[5])~data[, 3])
points(exp(log(data[, 1])/parafemale[1])* exp(parafemale[4])~data[, 1])
points(exp(log(data[, 3])/parafemale[3])* exp(parafemale[6])~data[, 3])
points(exp(log(data[, 3])/parafemale[3])* exp(parafemale[6])~data[, 3], col = "blue")
parafemale
paramale
load("/Users/fjiang/harv/harvard/accleft/pc.Rdata")
pc
 ls()
str(PC)
attach(PC)
sum(race_nowhite)
sum(race_noWhite)
sum(los3w)
subpc <- PC[Age >= 1, ]
nrow(subpc)
sum(subpc$los3w)
sum(subpc$disch_snf)
sum(subpc$risk4_)
sum(subpc$risk2_3)
sum(subpc$disch_homecare)
load("/Users/fjiang/harv/harvard/accleft/realdata")
ls()
survData[, 4]
sum(survData[, 4])
457/621
sum(survData[, 2])
survData[, 2]
load("/Users/fjiang/harv/harvard/accleft/pc.Rdata")
str(PC)
sum(PC$delta1)
mean(PC$delta1)
90/621
attach(PC)
sum(Age <= 0.5)
sum(Age <= 0)
sum(Age <= 0, delta1 = 1)
sum(Age <= 0, delta1 == 1)
sum(Age <= 0&delta1 == 1)
sum(Age <= -0.5&delta1 == 1)
sum(Age <= -0.5)
sum(Age <= -2)
sum(Age <= -2.5)
summary(Age)
sum(Age <= -2.6)
sum(Age <= -2.6&delta1 == 1)
421 /1185
sum(survData[, 4])
457/621
load("realdata)
")
load("/Users/fjiang/harv/harvard/accleft/realdata")
survData
sd(survData[, c(1, 3))
sd(survData[, c(1, 3)])
load("realdata")
ls()
survDara[, c(1, 3)] <-  survDara[, c(1, 3)]/sd( survDara[, c(1, 3)])
survData[, c(1, 3)] <-  survData[, c(1, 3)]/sd( survData[, c(1, 3)])
plot(density(survdata[survData[, 2]==1, 3]))
plot(density(survData[survData[, 2]==1, 3]))
plot(density(log(survData[survData[, 2]==1, 3])))
plot(density(log(survData[survData[, 2]==1, 3]/5)))
plot(density(((survData[survData[, 2]==1, 3])^2 - 1)/2))
plot(density((log(survData[survData[, 2]==1, 3])^2 - 1)/2))
plot(density((log(survData[survData[, 2]==1, 3])^1/2 - 1)/0.5))
load("realdata")
plot(density(survData[survData[, 2]==1, 3]))
plot(density(log(survData[survData[, 2]==1, 3]/5)))
log(log(survData[, 3]))
load("realresult")
survData
ls()
load("realdata")
mean(survData[, 2])
mean(survData[, 4])
